# build.yml
---
name: build

on:
  workflow_call:
    inputs:
      aaxclean-version:
        type: string
        description: "Libation version number"
        required: true
      dotnet-version:
        type: string
        default: "10.x"
        description: ".NET version to target"

jobs:

  linux:
    strategy:
      matrix:
        include:
          - architecture: arm64
          - architecture: x64
            native: Native
    uses: ./.github/workflows/build-linux.yml
    with:
      aaxclean-version: ${{ inputs.aaxclean-version }}
      dotnet-version: ${{ inputs.dotnet-version }}
      architecture: ${{ matrix.architecture }}
      native: ${{ matrix.native }}
      
  mac:
    strategy:
      matrix:
        architecture: [arm64, x64]
    uses: ./.github/workflows/build-mac.yml
    with:
      aaxclean-version: ${{ inputs.aaxclean-version }}
      dotnet-version: ${{ inputs.dotnet-version }}
      architecture: ${{ matrix.architecture }}
      native: Native
      
  windows:
    strategy:
      matrix:
        architecture: [x86, x64]
    uses: ./.github/workflows/build-windows.yml
    with:
      aaxclean-version: ${{ inputs.aaxclean-version }}
      dotnet-version: ${{ inputs.dotnet-version }}
      architecture: ${{ matrix.architecture }}